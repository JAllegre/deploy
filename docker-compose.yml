version: "3.8"

services:
  rproxy:
    container_name: rproxy
    image: "rproxy:latest"
    volumes:
       - /etc/letsencrypt/live/jallegre.freeboxos.fr:/etc/letsencrypt/live/jallegre.freeboxos.fr
    build:
      context: ../rproxy
    ports:
      - 80:80
      - 443:443
    # depends_on:
    #   - miam
    #   - cv
    deploy:
      restart_policy:
        condition: any
  cv:
    container_name: cv
    image: "cv:latest"
    environment:
      - PORT=8082
    build:
      context: ../cv
    deploy:
      restart_policy:
        condition: any
  # miam:
  #   container_name: miam
  #   image: "miam:latest"
  #   environment:
  #     - PORT=8081
  #   build:
  #     context: ../miam
  #   volumes:
  #     - /data/miamdb:/data/miamdb
  #   deploy:
  #     restart_policy:
  #       condition: any
